# Design

```{r}
library(tidyverse)
library(mrgsolve)
library(satchel)
```


```{r}
satchel <- Satchel$new("design", "../data/derived/satchel")
```


```{r}
models <- source("../modeling/models.R")$value

models$available()
```

```{r}
mod <- models$use("capparelli")
#mod <- models$use("stockmann")
```

```{r}
reg1 <-data_frame(ID=1, rate= -2, cmt=1, time=0, evid=1, regimen=1,
                      dose=c(15),
                      amt=c(15)*15,
                      #SCR = c(0.2,0.4,0.8,1.0,1.2,1.8,2.0,2.4,2.8),
                      ii=c(6), 
                      addl=c(6))
reg2 <- reg1 %>% mutate(ID=2,ii=8)
dose_df <- bind_rows(reg1,reg2)
# View(dose_df)
```

```{r}
mod %>% 
  data_set(dose_df) %>% param(BW=15) %>% 
  carry.out(dose,amt,ii,addl,regimen,SCR) %>%
  Req(CP) %>% 
  mrgsim(delta=0.1, end=120) %>% plot
```

